import HowItWorksDiagram from '../assets/getting-started-how-superface-works.svg';

# Getting started

Superface is all about providing you the best way to consume digital capabilities provided by APIs. This guide shows you how to Pick a use case and its provider from our Catalog, and use Superface OneSDK to make the API call.

## Superface in 3 minutes

The following steps will guide you through quickly getting started with Superface and OneSDK.

:::info Prerequisites

This guide assumes you have [Node.js](https://nodejs.dev/) version 14 or newer installed.

:::

<div class="count-steps-h3">

### Pick a use case

Pick a use case you would like to use in your App from [Superface catalog](https://superface.ai/catalog). Each use case is identified by profile ID and use case name. Profiles are the files where use cases live.

If your use case or provider is missing, you can create the integration yourself by following [How to Create a Capability](guides/how-to-create.md) guide or [let us know](support) and we'll add it to the catalog.

In this guide we will use the use case **Get User Repositories** which retrives GitHub, GitLab or Bitbucket repositories of specified user. Its profile ID is `vcs/user-repos` and use case name is `UserRepos`.

To see a detailed description of the use case, check the [`vcs/user-repos` profile page](https://superface.ai/vcs/user-repos).

### Pick a provider

The next step is to **pick a provider you would like to use**. In this guide we will use the `github`. You can find the list of supported use case providers at [`vcs/user-repos` profile page](https://superface.ai/vcs/user-repos).

:::note Provider authentication
In many cases you also need to set up provider credentials. Since we
are using the unauthenticated GitHub API we can skip it for now.

To learn how to handle API credentials, see [Setting provider API keys](guides/api-keys.md).

:::

### Install OneSDK

In your App directory, install the OneSDK library:

```shell
npm install @superfaceai/one-sdk
```

### Code

Finally, use OneSDK in your App. Create the `index.js` file with the following JavaScript code:

<!-- prettier-ignore-start -->

```js title="index.js"
const { SuperfaceClient } = require('@superfaceai/one-sdk');
const sdk = new SuperfaceClient();

async function main() {
  // Load the profile identified by profile ID and optional profile version
  const profile = await sdk.getProfile('vcs/user-repos@2.0.1');

  // Load use case, pass use case name as argument
  const useCase = profile.getUseCase('UserRepos');

  // Invoke the use case, pass user in perform input parameter and provider name in perform options
  const result = await useCase
    .perform({
      user: 'superfaceai', //use case input, in our case GitHub user name
    }, {
      provider: 'github' //provider name
    });

  // Handle the result
  try {
    const data = result.unwrap();
    console.log(data);
  } catch (error) {
    console.error(error);
  }
}

main();
```

<!-- prettier-ignore-end -->

:::note Profile ID, use case name and provider name parameters
Note that we passed previously picked profile ID `vcs/user-repos` as parameter to `getProfile` function, use case name as parameter to `getUseCase` function and provider name as parameter to `perform` function.

:::

:::note Profile version
Best practice is to pin your application to the latest version of the profile. By pinning the version you will get consistent output without breaking changes once new major version of the profile is published to Superface registry.

:::

### Run

Now it is the time to execute your App:

```shell
node index.js
```

<details>
<summary>Example output</summary>

```
{
  repos: [
    {
      name: 'astexplorer',
      description: 'A web tool to explore the ASTs generated by various parsers.'
    },
    {
      name: 'banking-demo',
      description: 'Demo of Superface banking use-cases'
    },
    {
      name: 'chat-demo',
      description: 'Express server for OAuth flow and examples of messaging use-cases for Discord and Slack'
    },
    {
      name: 'cli',
      description: 'Do not program API integrations! Install them.'
    },
    {
      name: 'demo-ballistic-sombrero',
      description: 'Demo of Koana Islands Weather Alerts provider'
    },
    {
      name: 'demo-koana-islands',
      description: 'Demo of Koana Islands Weather Alerts'
    },
    {
      name: 'demo-winter-beechnut',
      description: 'Demo of an alternative Koana Islands Weather Alerts provider'
    },
    {
      name: 'docs',
      description: 'Superface.ai & Comlink documentation. '
    },
    { name: 'email-demo', description: undefined },
    {
      name: 'example-glitch-email',
      description: 'Glitch example showcasing email failover on SendEmail use case'
    },
    {
      name: 'example-glitch-geocode',
      description: 'Glitch example showcasing Geocode use case'
    },
    {
      name: 'example-glitch-reverse-geocode',
      description: 'Glitch example showcasing ReverseGeocode use case'
    },
    {
      name: 'language-client-vscode',
      description: 'VS Code extension for the Comlink language.'
    },
    { name: 'language-server', description: undefined },
    { name: 'nestjs-appsignal-example', description: undefined },
    {
      name: 'one-sdk-js',
      description: '1️⃣ One Node.js SDK for all the APIs you want to integrate with'
    },
    {
      name: 'parser',
      description: 'Superface profile and map format parser'
    },
    { name: 'passport-twitter-oauth2', description: undefined },
    { name: 'pinterest-demo', description: undefined },
    {
      name: 'profiles',
      description: 'Source repository of public profiles'
    },
    { name: 'release-changelog-action', description: undefined },
    { name: 'resilient-email-tutorial', description: undefined },
    {
      name: 'service-client',
      description: 'Library provides client for superface backend apis.'
    },
    {
      name: 'slack-demo',
      description: 'Demo of chat integrations with Slack'
    },
    {
      name: 'spec',
      description: 'The Comlink Specification. Comlink is a new interface description and integration language build self-integrating applications. '
    },
    {
      name: 'station',
      description: 'Comlink metadata for self-integrating applications.'
    },
    {
      name: 'superdriver',
      description: 'DEPRECATED: The original version of Superface SDK based on ALPS profile and OAS extensions. Do not use.'
    },
    { name: 'superface-cli', description: 'Superface CLI tool' },
    {
      name: 'superface-daily',
      description: 'Personal daily integration tests for Superface CLI and OneSDK'
    },
    {
      name: 'testing',
      description: 'Library to enable easier testing of Superface use cases.'
    }
  ]
}
```

</details>

### Check the HTTP communication

Set the environment variable `DEBUG` to `superface:http*` to see API calls from OneSDK to GitHub API:

```shell
DEBUG="superface:http*" node index.js
```

:::caution
This can print out potentially sensitive information.
:::

Set the DEBUG environment variable to `superface*` to see everything what is going in under the hood.

### Understand runtime integration

During the App runtime, OneSDK downloads a Comlink map from Superface servers. The Comlink map instructs the OneSDK how to make the direct call to GitHub API to perform the capability.

OneSDK optionally downloads the Comlink profile, which contains use-case definition.  You can either, instruct OneSDK to download the profile in runtime or download the profile at design time using Superface CLI and store it along with your source code.

You can always check the Comlink map at profile's detail page for the given provider by clicking the "raw" link. For example here's the [latest map for `vcs/user-repos` and `github`](https://superface.ai/raw/vcs/user-repos.github@2.0.suma).

</div>

## Next step

With your first capability set up, you can now [start monitoring the integrations](./guides/integrations-monitoring.mdx) in Superface insights.
